function setSizes(){var t=$(window).height()-50;$(".content").height(t);var e=$(".content").height()/2,n=e+30;$(".content-block").height(e),$(".chart-wrap").height(e),$("iframe.carto-db").css("height",n)}function revealers(){$(document).on("click",".chart-reveal",function(){var t=$(".charts");t.hasClass("chart-open")?t.removeClass("chart-open"):t.addClass("chart-open")}),$(document).on("click",".about-reveal",function(){var t=$(".about");t.hasClass("about-open")?t.removeClass("about-open"):t.addClass("about-open")}),$(document).on("click",".about-unreveal",function(){var t=$(".about");t.removeClass("about-open")}),$(document).on("click",".legend-reveal",function(){var t=$(".legend");t.hasClass("legend-open")?(t.removeClass("legend-open"),setTimeout(function(){t.hide()},300)):(t.addClass("legend-open"),t.css("display","block"))}),$(document).on("click",".legend-unreveal",function(){var t=$(".legend");t.removeClass("legend-open"),setTimeout(function(){t.hide()},300)})}function chartist(){var t={top:20,right:50,bottom:50,left:100},e=.75*$(window).width()-t.left-t.right,n=$(".content").height()/2-t.top-t.bottom,a=d3.scale.linear().range([0,e]),r=d3.scale.linear().range([n,0]),o=d3.svg.axis().scale(a).orient("bottom"),s=d3.svg.axis().scale(r).orient("left"),l=d3.scale.category10(),c=d3.svg.line().interpolate("basis").x(function(t){return a(t.hour)}).y(function(t){return r(t.returns)}),i=d3.select("#harvard-chart svg").attr("width",e+t.left+t.right).attr("height",n+t.top+t.bottom).append("g").attr("transform","translate("+t.left+","+t.top+")"),u=d3.select("#kendall-chart svg").attr("width",e+t.left+t.right).attr("height",n+t.top+t.bottom).append("g").attr("transform","translate("+t.left+","+t.top+")");d3.csv("./data/harvard_web2.csv",function(t,u){l.domain(d3.keys(u[0]).filter(function(t){return"Hour"!==t})),u.forEach(function(t){t.hour=parseInt(t.Hour)});var d=l.domain().map(function(t){return{name:t,values:u.map(function(e){return{hour:e.hour,returns:+e[t]}})}});console.log(d);var h=d,p=d.slice(0,1);console.log(p);a.domain(d3.extent(u,function(t){return t.hour})),r.domain([d3.min(d,function(t){return d3.min(t.values,function(t){return t.returns})}),d3.max(d,function(t){return d3.max(t.values,function(t){return t.returns})})+200]),i.append("g").attr("class","x axis").attr("transform","translate(0,"+n+")").call(o).append("text").attr("x",e).attr("y",40).style("text-anchor","end").text("Hour of Day"),i.append("g").attr("class","y axis").call(s).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end").text("Hubway Returns to Harvard Stations");var f=i.selectAll(".line").data(h).enter().append("g").attr("class","line");f.append("path").attr("class","path").attr("class",function(t){return"path "+t.name}).attr("d",0).attr("d",function(t){return c(t.values)}).transition().style("opacity",1)}),d3.csv("./data/kendall_web.csv",function(t,i){l.domain(d3.keys(i[0]).filter(function(t){return"Hour"!==t})),i.forEach(function(t){t.hour=parseInt(t.Hour)});var d=l.domain().map(function(t){return{name:t,values:i.map(function(e){return{hour:e.hour,returns:+e[t]}})}});console.log(d);var h=d,p=d.slice(0,1);console.log(p);a.domain(d3.extent(i,function(t){return t.hour})),r.domain([d3.min(d,function(t){return d3.min(t.values,function(t){return t.returns})}),d3.max(d,function(t){return d3.max(t.values,function(t){return t.returns})})]),u.append("g").attr("class","x axis").attr("transform","translate(0,"+n+")").call(o).append("text").attr("x",e).attr("y",40).style("text-anchor","end").text("Hour of Day"),u.append("g").attr("class","y axis").call(s).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end").text("Hubway Returns to Kendall Stations");var f=u.selectAll(".line").data(h).enter().append("g").attr("class","line");f.append("path").attr("class","path").attr("class",function(t){return"path "+t.name}).attr("d",0).attr("d",function(t){return c(t.values)}).transition().style("opacity",1)})}$(document).ready(function(){setSizes(),revealers(),chartist(),$(".about .reader").perfectScrollbar()}),$(window).resize(function(){setSizes()});